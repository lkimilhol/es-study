## 색인이란

문서를 분석하고 저장하는 과정을 색인 이라고 정의

## 색인 과정

<img width="1174" alt="image" src="https://user-images.githubusercontent.com/14123772/224055067-a9e99749-939e-4645-a1dd-d50a93faa41f.png">

## 색인 과정

데이터 노드는 총 3개라고 가정

1. PUT /books/_doc_1 색인 요청
2. 인덱스가 없으면 인덱스를 만 듦 -> boos라는 index가 생성 -> number_of_shards, number_of_replicas 둘 다 1
3. PUT /books/_doc_2 색인 요청
4. 프라이머리 샤드로 갔다가 (1번 데이터 노드) -> 레플리카로 복제가 됨 (2번 데이터 노드)
5. 3번 노드는 아예 사용이 안됨

위의 경우에는 클러스터로서의 이점을 전혀 살리지 못하는 상황 -> 노드 개수를 올려도 이점이 없음

적잘한 수의 샤드 개수를 설정하는 것이 성능에 큰 영향을 미침

샤드의 개수가 고르게 분배되지 않으면 용량 불균형이 일어날 수 있음
데이터 노드를 늘려도 용량이 고르게 분배되지 않는 이유가 위의 경우

배치 계획을 세우고 -> 테스트 -> 우리 서비스에 맞는 샤드 배치를 계획을 완성 시켜 나가야 함

